(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7613],{87864:function(t,e,s){"use strict";s.d(e,{A:function(){return h}});var i=s(5479),n=s.n(i),a=s(81580),o=(s(48073),s(24330)),r=s.n(o),l=s(49935),c=s(6145),d=s(28951);class h{constructor(t){this.config={placeholder:"Select wallets",...t};const{container:e}=this.config,s=this;this.$container=("string"===typeof e?n()(e):e).first(),this.$counter=this.$container.find(".js-wdd__counter"),this.$wallets=this.$container.find(".js-wdd__wallets"),this.$addresses=this.$container.find(".js-wdd__addresses"),this.$items=this.$container.find(".js-wdd__item"),this.$split=this.$container.find(".js-wdd__split"),this.$consolidate=this.$container.find(".js-wdd__consolidate"),this.config.type=this.$container.data("type"),this.$container._walletsDropdown=this,this.uid=r()(),this.toggleLoader(!0),this.init(),this.config.disableSync||n()(document).on("walletsDropdown:change",(function(t,{instance:e,selectedAddesses:i}){i&&e!==s&&(s.checkWallets(i),s.config.initSelectedAddresses=[...i],s.config.onChecked&&s.config.onChecked(s),s.$container.trigger("change"))})),this.$split.on("click",(async function(){const t=s.getSelectedAddresses("quote");if(!t?.length)return;const{tokenAddress:e,poolId:i,is2022:o}=s.config,r={pool_id:i,wallets:t.join(",")},d=(0,a.qE)(t,e,o);d&&(r.associated_accs=d.join(",")),await(0,l.N)({$button:n()(this),url:"/api/purchases/split_tokens",data:r,onSuccess:t=>{if(t&&t.success)(0,c.Dy)(t,{timeoutMsg:a.I_});else{let e=t.error||"Something went wrong, please reload the page and try again.";flashError({message:e})}}})})),this.$split.length&&n()(document).on("userCable:splitTokens",(async function(t,{pool_id:e,status:i}={}){const{tokenAddress:n,tokenDecimals:o,is2022:r}=s.config;e&&parseInt(e)===parseInt(s.config.poolId)&&"success"===i&&await(0,a.oO)({tokenAddress:n,tokenDecimals:o,is_program_2022:r,forceFetch:!0})})),this.$consolidate.on("click",(async function(){const t=s.getSelectedAddresses("quote");if(n()(this).hasClass("is-disabled")||1!==t?.length)return;const{tokenAddress:e,poolId:i,is2022:o}=s.config,r=t[0],d=s.getAddresses("quote").filter((t=>t!==r)),h={pool_id:i,wallet:r},u=(0,a.qE)(d,e,o);u&&(h.associated_accs=u.join(",")),await(0,l.N)({$button:n()(this),url:"/api/purchases/consolidate_tokens",data:h,onSuccess:t=>{if(t&&t.success)(0,c.Dy)(t,{timeoutMsg:a.I_});else{let e=t.error||"Something went wrong, please reload the page and try again.";flashError({message:e})}}})})),this.$consolidate.length&&n()(document).on("userCable:consolidateTokens",(async function(t,{pool_id:e,status:i}={}){const{tokenAddress:n,tokenDecimals:o,is2022:r}=s.config;e&&parseInt(e)===parseInt(s.config.poolId)&&"success"===i&&await(0,a.oO)({tokenAddress:n,tokenDecimals:o,is_program_2022:r,forceFetch:!0})}))}setConfigValue(t,e){if(t)return this.config[t]=e,this.$container.attr(`data-${(0,a.ic)(t)}`,!0===e?"true":e),this}checkWallets(t=[]){this.$items.each((function(){try{const e=n()(this).attr("data-wallet");n()(this).find("input").prop("checked",t.includes(e))}catch(e){console.error(e)}})),this.refreshToggle(),this.config.onChecked&&this.config.onChecked(this),this.$container.trigger("checkWallets")}getItems(){return this.$container.find(".js-wdd__item")}setTokenAddress(t){return this.config.tokenAddress=t,this.$container.attr("data-token-address",t),this}setPoolId(t){return this.config.poolId=t,this.$container.attr("data-pool-id",t),this}setBalances(t,{reset:e}={}){let s={...this.config.balances};e&&(s=(0,a.LG)(s,(t=>0))),this.config.balances={...s,...t}}setTokenDecimals(t){return this.config.tokenDecimals=t,this.$container.attr("data-token-decimals",t),this}updateSeed(t,e){this.$items.each((function(){try{if(n()(this).attr("data-wallet")===t){const t=n()(this).find(".js-wdd__item__name__rocket");t.toggleClass("u-color-green",e),t.attr("data-tippy-content",e?"This wallet have node accelerator enabled":"This wallet does not have node accelerator enabled"),t[0]._tippy&&t[0]._tippy.destroy(),(0,d.Ay)(t[0],a.v1)}}catch(s){console.error(s)}}))}selectWallets(t=[],e,{showWallets:s}={}){const i=t?Array.isArray(t)?t:[t]:null;this.getItems().removeClass("is-hidden").map((function(){const t=n()(this).find("input").prop("checked",!1),{wallet:o}=n()(this).data();if(i)o&&i.includes(o)?t.prop("checked",!0):s?.length&&!s.includes(o)&&n()(this).addClass("is-hidden");else{const s=parseFloat(n()(this).find(".js-wdd__item__value").attr(`data${(0,a.gD)(e)?"":`-${e}`}-balance`))||0;t.prop("checked",s>0)}})),this.refreshToggle()}fillBalances(t,e,s){try{if(!t||(0,a.Im)(t))return;const i=this.config.type;this.getItems().map((function(){const{wallet:o}=n()(this).data();if(Object.entries(t).forEach((([t,e])=>{if(!e)return;const s=e[o]||0;n()(this).find(`.js-wdd__item__value[data-type="${t}"]`).attr(`data-${t}-balance`,s||0).text((0,a.M2)(s||0,4)),"quote"!==i&&i||n()(this).find(`.js-wdd__item__subvalue[data-type="${t}"]`).text((0,a.gp)({numb:s*window.solUsdPrice||0,unit:"$",fractionLength:4}))})),s?.length||e){const a=i?(t[i]||{})[o]>0:(t.quote||{})[o]>0||(t.token||{})[o]>0;n()(this).find("input").prop("checked",s&&s.length?s.includes(o):!!e&&a)}})),this.refreshToggle(),this.$container.trigger("fillBalance")}catch(i){console.error(i)}return this}getWallets(t){let e=[];const s=t||this.config.type,i=`data${(0,a.gD)(s)?"":`-${s}`}-balance`;return this.getItems().each((function(){e.push({name:n()(this).find(".js-wdd__item__name").text().trim().replaceAll("\n",""),address:n()(this).data("wallet"),balance:parseFloat(n()(this).find(`[${i}]`).attr(i))||0,quote:parseFloat(n()(this).find("[data-quote-balance]").attr("data-quote-balance"))||0,token:parseFloat(n()(this).find("[data-token-balance]").attr("data-token-balance"))||0,checked:n()(this).find("input").is(":checked")})})),e}getAddresses(t){return this.getWallets(t).map((({address:t})=>t))}getSelectedWallets(t){return this.getWallets(t).filter((({checked:t})=>t))}getSelectedAddresses(t){return this.getSelectedWallets(t).map((({address:t})=>t))}getSelectedWalletsParam(){return this.getSelectedAddresses().join(",")}refreshToggle(t){const e=this.getSelectedWallets(t);return this.$wallets.text(e.length?e.map((({name:t})=>t)).join(", "):this.config.placeholder),this.$addresses.text(e.map((({address:t})=>(0,a.Wr)(t))).join(", ")),this.$counter.text(e.length),this.checkConsolidate(),this}toggleLoader(t){const{disableSync:e,type:s}=this.config;this.$container.removeClass("is-loading is-disabled is-item-loading");const i=e?"is-loading is-disabled":""+("quote"===s?"is-loading is-disabled":"is-item-loading");return this.$container.toggleClass(i,t),this}checkConsolidate(){if(this.$consolidate?.length){const t=this.getSelectedAddresses();this.$consolidate.toggleClass("is-disabled",1!==t?.length)}}init({checkPositive:t}={}){const{balances:e,type:s,initSelectedAddresses:i,onChecked:o,onInit:r,tokenAddress:l,checkPositive:c,disableSync:d,configType:h,enableConfigSave:u}=this.config,p=this;this.isUserUpdated=!1,this.toggleLoader(!0);let f=!1;return this.getItems().removeClass("is-hidden"),this.fillBalances(e||{},(0,a.gD)(t)?c:t,i),(e?.quote||e?.token)&&(p.toggleLoader(!1),f||(p.$container.trigger("firstFillBalance"),f=!0),r&&r(this)),n()(document).off(`wallets:updateSeed.${this.uid}`).on(`wallets:updateSeed.${this.uid}`,(function(t,e,s){p.updateSeed(e,s)})),n()(document).off(`wallets:retrieveBalances.${this.uid}`).on(`wallets:retrieveBalances.${this.uid}`,(function(t,{type:e,tokenAddress:i,balances:n},{disableCheckPositive:a}={}){if(s&&e===s&&n[s]||!s&&(n?.quote||n?.token)){if("token"===e&&(!i||!l||l!==i))return;p.fillBalances(n,c&&!a&&!p.isUserUpdated,f?void 0:p.config.initSelectedAddresses),p.toggleLoader(!1),f||(p.$container.trigger("firstFillBalance"),f=!0),r&&r(p)}})),this.$container.off(`change.${this.uid}`).on(`change.${this.uid}`,'input[type="checkbox"]',(function(){p.refreshToggle(),p.isUserUpdated=!0;const t=p.getSelectedAddresses();d||(window.selectedWallets=t,p.config.initSelectedAddresses=[...t]),d&&!u||(0,a.YQ)(t,h),o&&o(p),p.$container.trigger("change"),d||n()(document).trigger("walletsDropdown:change",[{instance:p,selectedAddesses:p.getSelectedAddresses()}])})),n()(document).on("dd:toggle",((t,{$element:e,active:s})=>{e.is(this.$container)&&this.$container.trigger("walletsDropdown:toggle",[{$element:e,active:s}])})),this}}},16937:function(t,e,s){"use strict";s.d(e,{Ah:function(){return g},V0:function(){return y},bY:function(){return h},jB:function(){return d},m0:function(){return _}});var i=s(5479),n=s.n(i),a=s(81580),o=s(48073),r=s(73617),l=s(92483),c=s.n(l);const d=new Intl.NumberFormat("en-US",{minimumFractionDigits:6,maximumFractionDigits:6}),h=({form:t,priceForm:e})=>{const s=e||t.find("[data-price-form]"),i=t.find(".js-wdd")[0]._walletsDropdown.getSelectedAddresses(),n=t.find(".js-buy-btn__amount"),o=s[0].getFieldValue()||{};if(!o)return void n.empty();let r=(0,a.vC)((0,a.M2)(o.value*i.length));r?n.html(` <div class="c-icon c-icon--3xs c-icon--sol-solid"></div>${r}`):n.empty()};let u={};window._pricePoolDataMap={},n()((function(){}));const p=({amountIn:t,reserveIn:e,reserveOut:s,priority:i=0,bribery:n=0,dexFee:o=25})=>{const r=function(t,e,s,i=25){const n=t*(1e4-i);return n*s/(1e4*e+n)}(t,e,s,o);!function(t,e,s,i){const n=t*i,a=e*s-n;Math.abs(parseFloat(a))}(t,r,e,s);return r/a.Sr*(1-a.Vl)-i-n-a.fL},f=["raydium_amm","raydium_cpmm","pump","pump_amm","boop","moonshot","raydium_launchpad"],m=["bonk",0,"0"],g=async({data:t,settingsData:e,force:s,poolId:i,poolFactoryName:n,poolPlatform:l,poolData:d,investedEth:h,remainingEth:g,is_program_2022:_,tokenAddress:y,tokenDecimals:w,wallets:v})=>{if("raydium_launchpad"!==n||m.includes(l)&&!_||(n=null),!n||!f.includes(n)||window.stablePoolIds&&window.stablePoolIds.includes(parseInt(i)))return[null,!1];const k=Math.min(h,g);if(!t||!t.value||!g)return[null,!1];let $,b,I;const A=parseFloat((0,a.vC)(t.value));if("percent"===t.type?"initial"===t.value?($=k,I="sol"):(b=A,I="perc"):"quote"===t.type&&($=A,I="sol"),"sol"===I&&(0,a.gD)($)||"perc"===I&&(0,a.gD)(b))return[null,!1];const x="perc"===I;if(!I)return[null,!1];let D;try{D=await(async({poolId:t,factoryName:e,amount:s,force:i,isPercentage:n,priority:l=0,bribery:d=0,poolData:h,is_program_2022:f,tokenAddress:m,tokenDecimals:g,wallets:_})=>{const y=t||(0,o.Lx)();let w=!0,{decimals:v,priceQuote:k,quoteToken0:$,reserve0:b,reserve1:I,reserve0Tr:A,reserve1Tr:x,ignored:D,feesData:j={}}=h;const C=h.isUsdLike||(0,o.e0)(h.quote_token_i),S=["pump","moonshot","boop","raydium_launchpad"].includes(e);if(A=S?b:A||b,x=S?I:x||I,C&&($?A=A/window.solUsdPrice*1e3:x=x/window.solUsdPrice*1e3),u[y]&&!i)return{balance:0,percentage:0,quote:0,success:!1};let F=await(0,a.Uu)({tokenAddress:m,tokenDecimals:g,wallets:_,total:!0,is_program_2022:f,onBeforeFetch:()=>{u[y]=!0},onAfterFetch:()=>{delete u[y]}}),q=0,T=0,L=0;if(!e||parseInt(F)<=0||!_?.length)return{balance:F,percentage:q,quote:T,success:w};if(n)q=s,L=q>=100?F:new r.A(F).mul(q).dividedBy(100).toNumber();else{const t=k*F;q=s>=t?100:new r.A(s).mul(100).dividedBy(t).toNumber(),L=q>=100?F:new r.A(F).mul(q).dividedBy(100).toNumber(),L>F&&(L=F)}const{reserveOut:P,reserveIn:B}=function(t,e,s){return{reserveOut:s?t:e,reserveIn:s?e:t}}(A,x,$);let W;switch(L=parseInt(L*Math.pow(10,g)),e){case"pump_amm":case"raydium_amm":case"raydium_cpmm":W=25;break;case"pump":default:W=0;break;case"moonshot":case"boop":W=100}if("raydium_launchpad"===e){const t=(t,e,s)=>t.mul(e).add(s).subn(1).div(s),e=new(c())(0),s=new(c())(`${j.globalTradeFeeRate||0}`),i=new(c())(`${j.platformfeeRate||0}`),n=s.add(i),a=new(c())(1e6);L=new(c())(`${L}`),L=L.sub(e).sub(t(L,n,a))}return T=p({amountIn:L,reserveIn:B,reserveOut:P,priority:l,bribery:d,dexFee:W}),{balance:F,percentage:q,quote:T,success:w}})({poolId:i,factoryName:n,amount:x?b:$,force:s,isPercentage:x,priority:e&&!(0,a.gD)(e.priority)?e.priority:0,bribery:e.bribery,poolData:d,is_program_2022:_,tokenAddress:y,tokenDecimals:w,wallets:v})}catch(j){console.error(j),D={success:!1,quote:0}}return D?[D.quote||0,!0]:[0,!1]},_=async({form:t,priceForm:e,force:s,...i})=>{try{const n=e||t.find("[data-price-form]"),o=t.find(".js-sell-btn__amount"),r=t.find('.js-w-form__gas-settings[data-type="purchase"]')[0].collectData(),l=n[0].getFieldValue()||{},[c,h]=await g({data:l,settingsData:r,force:s,...i});if(h){if((0,a.gD)(c))return void o.empty();o.html(` <div class="c-icon c-icon--3xs c-icon--sol-solid"></div>${d.format(c)}`)}else o.empty()}catch(n){console.error(n)}},y=({wrapper:t=".js-price-form",btn:e=".js-price-form__btn",input:s=".js-price-form__input",ddItem:i=".js-price-form__type__item",onBtnClick:o}={})=>{const r="string"===typeof t?n()(t):t,l=e=>"string"===typeof t?e.closest(t):r;r.on("input",s,(function(t){n()(this).val((0,a.vC)(n()(this).val())),l(n()(this)).trigger("input",[n()(this).val(),n()(this)])})),r.on("click",i,(function(t){const e=l(n()(this)).find(s),i=n()(this).data("type");e.attr("data-type",i);const o=n()(this).data("placeholder");if(o&&e.attr("placeholder",o),e.val()){const t={value:e.val(),type:e.attr("data-type")};l(n()(this)).data("value",t),l(n()(this)).trigger("change",[t,n()(this)])}(0,a.Pu)("sell_amt_type",i)})),r.on("focus",s,(function(t){l(n()(this)).find(e).removeClass("is-selected"),l(n()(this)).removeData("value"),n()(this).closest(".c-w-form__amount__field").addClass("is-selected")}));const c=t=>{const i=t.find(e),n=t.find(s);n.val(""),n.closest(".c-w-form__amount__field").removeClass("is-selected"),i.removeClass("is-selected"),t.removeData("value"),t.trigger("change")};r.each((function(){this.resetForm=()=>c(n()(this))})),r.on("change",s,(function(t){l(n()(this)).find(e).removeClass("is-selected");const s={value:n()(this).val(),type:n()(this).attr("data-type")};l(n()(this)).data("value",s),l(n()(this)).trigger("change",[s,n()(this)])}));const d=(t,e)=>{const i=r.find(s);i.val((0,a.aI)(t));const n={value:t,type:e||i.attr("data-type")};r.data("value",n)};return r.on("click",e,(function(t){t.preventDefault();const i=l(n()(this)).find(e),a=l(n()(this)).find(s);i.removeClass("is-selected"),n()(this).addClass("is-selected");const r={value:n()(this).attr("data-value"),type:n()(this).attr("data-type")};a.val("").closest(".c-w-form__amount__field").removeClass("is-selected"),l(n()(this)).data("value",r),o&&o(r,{$btn:n()(this),setInputValue:d}),l(n()(this)).trigger("change",[r,n()(this)])})),r.each((function(){this.getFieldValue=()=>{const t=n()(this).find(s),i=n()(this).find(e).filter(".is-selected");return t.val()?{value:t.val(),type:t.attr("data-type")}:i.length?{value:i.attr("data-value"),type:i.data("type")}:void 0}})),{setInputValue:d,resetForm:c}}},41794:function(t,e,s){"use strict";s.d(e,{A:function(){return l}});var i=s(5479),n=s.n(i),a=s(81580),o=s(28951);const r={lowlq:{title:i18n.t("alert.lowlq.title"),text:i18n.t("alert.lowlq.text"),icon:"lowlq"},mpools:{title:i18n.t("alert.mpools.title"),text:i18n.t("alert.mpools.text"),text2:i18n.t("alert.mpools.text2"),icon:"mpools"},freeze:{title:i18n.t("alert.freeze_auth.title"),text:i18n.t("alert.freeze_auth.text"),icon:"freeze"},fake_pump:{title:i18n.t("alert.fake_pump.title"),text:i18n.t("alert.fake_pump.text"),icon:"no-pump"},fake_raydium_launchpad:{title:i18n.t("alert.fake_raydium_launchpad.title"),text:i18n.t("alert.fake_raydium_launchpad.text"),icon:"no-launchpad"},fake_meteora_virtual_curve:{title:i18n.t("alert.fake_meteora_virtual_curve.title"),text:i18n.t("alert.fake_meteora_virtual_curve.text"),icon:"no-meteora"},fake_boop:{title:i18n.t("alert.fake_boop.title"),text:i18n.t("alert.fake_boop.text"),icon:"no-boop"},fake_orca_wavebreak:{title:i18n.t("alert.fake_orca_wavebreak.title"),text:i18n.t("alert.fake_orca_wavebreak.text"),icon:"no-orca_wavebreak"},fake_moonshot:{title:i18n.t("alert.fake_moonshot.title"),text:i18n.t("alert.fake_moonshot.text"),icon:"no-moonshot"},fake_memelive:{title:i18n.t("alert.fake_memelive.title"),text:i18n.t("alert.fake_memelive.text"),icon:"no-memelive"},pd:{title:i18n.t("alert.pd.title"),text:i18n.t("alert.pd.text"),icon:"close"},mayhem_mode:{title:i18n.t("alert.mayhem_mode.title"),text:i18n.t("alert.mayhem_mode.text"),icon:"mayhem-mode"}};class l{constructor(t){this.config=t,this.state={items:[]};const{container:e}=this.config;this.$container=("string"===typeof e?n()(e):e).first(),this.$icons=this.$container.find(".js-warnings__icons"),this.$popup=this.$container.find(".js-warnings__popup"),this.$label=this.$container.find(".js-warnings__label"),this.initLayout(),n()(document).on("warnings:show",((t,{alerts:e,poolId:s}={})=>{const i=this.config.poolId;e.length&&i&&s&&i.toString()===s.toString()&&this.showAlerts(e)})),n()(document).on("warnings:hide",((t,{alerts:e,poolId:s}={})=>{const i=this.config.poolId;e.length&&i&&s&&i===s&&this.hideAlerts(e)}))}initLayout(){const t=this.$icons.find("[data-type]").toArray().map((t=>({type:n()(t).data("type")})));this.state.items=t,this.updateLayout()}hideAlerts(t=[]){this.state.items=this.state.items.filter((({type:e})=>!t.includes(e))),this.updateLayout()}showAlerts(t=[]){if(!t.length)return;const e=this.state;t.forEach((t=>{e.items.find((e=>e.type===t))||this.state.items.push({type:t})})),this.updateLayout()}updateLayout(){const{items:t}=this.state,e=t.length;this.$label.html(`${e||0} ${1===e?i18n.t("warning"):i18n.t("warnings")}`);const s=t.map((({type:t})=>this.createItem(t)));this.destroyTooltips(),this.$popup.empty().append(s),this.$container.toggleClass("is-hidden",!t.length),this.$icons.empty().append(t.map((({type:t})=>this.createIcon(t)))),this.initTooltips()}destroyTooltips(){this.$popup.find(".js-warnings__item").each((function(t){n()(this)[0]._tippy&&n()(this)[0]._tippy.destroy()}))}initTooltips(){this.$popup.find(".js-warnings__item").each((function(t){const e=n()(this).data("type"),s=r[e].text;(0,o.Ay)(n()(this)[0],{...a.v1,content:s,placement:(0,a.rr)()?"top":"left"})}))}createIcon(t){return`\n      <div class="c-icon c-warnings__pic js-warnings__pic" data-icon="${r[t].icon}" data-type="${t}"></div>\n    `}createItem(t){return`\n      <div class="c-dropdown__link c-warnings__item js-warnings__item" data-type="${t}">\n        <div class="l-row l-row-gap--xxs u-align-items-center">\n          <div class="l-col-auto u-d-flex u-align-items-center">\n            <div class="c-icon c-warnings__pic u-m-0 u-color-yellow" data-icon="${r[t].icon}"></div>\n          </div>\n\n          <div class="l-col c-warnings__item__text">\n            ${r[t].title}\n          </div>\n\n        </div>\n      </div>\n    `}setPoolId(t){this.config.poolId=t,this.state.items=[],this.updateLayout()}}},30495:function(){}}]);